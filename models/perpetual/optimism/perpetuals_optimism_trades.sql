{{ config(
	schema = 'perpetuals_optimism_trades',
	alias = 'trades'
	)
}}

SELECT *
FROM (
	SELECT
		blockchain
		,block_time
		,virtual_asset
		,underlying_asset
		,market
		,market_address
		,volume_usd
		,fee_usd
		,margin_usd
		,trade
		,project
		,version
		,trader
		,volume_raw
		,tx_hash
		,tx_from
		,tx_to
		,evt_index
		,trade_id
	FROM {{ ref('perpetual_v2_optimism') }}

	UNION ALL

	SELECT
		blockchain
		,block_time
		,virtual_asset
		,underlying_asset
		,market
		,market_address
		,volume_usd
		,fee_usd
		,margin_usd
		,trade
		,project
		,version
		,trader
		,volume_raw
		,tx_hash
		,tx_from
		,tx_to
		,evt_index
		,trade_id
	FROM {{ ref('synthetix_optimism') }}

	UNION ALL

	SELECT
		blockchain
		,block_time
		,virtual_asset
		,underlying_asset
		,market
		,market_address
		,volume_usd
		,fee_usd
		,margin_usd
		,trade
		,project
		,version
		,trader
		,volume_raw
		,tx_hash
		,tx_from
		,tx_to
		,evt_index
		,trade_id
	FROM {{ ref('pika_v1_optimism') }}

	UNION ALL

	SELECT
		blockchain
		,block_time
		,virtual_asset
		,underlying_asset
		,market
		,market_address
		,volume_usd
		,fee_usd
		,margin_usd
		,trade
		,project
		,version
		,trader
		,volume_raw
		,tx_hash
		,tx_from
		,tx_to
		,evt_index
		,trade_id
	FROM {{ ref('pika_v2_optimism') }}

	UNION ALL

	SELECT
		blockchain
		,block_time
		,virtual_asset
		,underlying_asset
		,market
		,market_address
		,volume_usd
		,fee_usd
		,margin_usd
		,trade
		,project
		,version
		,trader
		,volume_raw
		,tx_hash
		,tx_from
		,tx_to
		,evt_index
		,trade_id
	FROM {{ ref('pika_v3_optimism') }}
	) AS t
